{% extends "base.html" %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/introductoryView.css') }}">
<style>
  /* Add additional styling to ensure form visibility */
  .auth-form {
    display: block !important;
    margin-top: 2rem;
    margin-bottom: 2rem;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    background-color: var(--bs-body-bg);
  }
  
  .form-group {
    margin-bottom: 1.5rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container app-container">
    <div class="app-header">
        <h1 class="display-4 app-title">Create an account</h1>
    </div>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}" role="alert">
            {{ message }}
          </div>
        {% endfor %}
      {% else %}
        <div class="alert alert-info" role="alert">
          Fill out the form below to create your Audiometry account.
        </div>
      {% endif %}
    {% endwith %}
    
    <form action="{{ url_for('signUp') }}" method="POST" id="signUpForm" class="auth-form">
        <h3 class="text-center mb-4">Join Audiometry</h3>
        
        <!-- Hidden input for the referrer -->
        <input type="hidden" id="referrerPage" name="referrer" value="{{ request.args.get('redirect', '/') }}">
        
        <div class="form-group">
            <label for="signUpEmail" class="form-label">Email Address</label>
            <div class="input-group">
                <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                <input type="email" name="email" id="signUpEmail" class="form-control" placeholder="Enter your email" required>
            </div>
        </div>
        
        <div class="form-group">
            <label for="signUpUsername" class="form-label">Username</label>
            <div class="input-group">
                <span class="input-group-text"><i class="fas fa-user"></i></span>
                <input type="text" name="username" id="signUpUsername" class="form-control" placeholder="Create a username" required>
            </div>
        </div>
        
        <div class="form-group">
            <label for="signUpPassword" class="form-label">Password</label>
            <div class="input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" name="password" id="signUpPassword" class="form-control" placeholder="Create a password" required minlength="8">
            </div>
            <small class="form-text text-muted">Password must be at least 8 characters long with letters and numbers</small>
        </div>
        
        <button type="button" id="createAccountBtn" class="btn btn-primary w-100">
            <i class="fas fa-user-plus me-2"></i>Create Account
        </button>
        
        <div class="form-footer mt-3">
            <p class="text-center">Already have an account? <a href="/">Log in here</a></p>
        </div>
    </form>
</div>

<!-- Sign Up Confirmation Modal -->
<div class="modal fade" id="confirmSignUpModal" tabindex="-1" aria-labelledby="confirmSignUpModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmSignUpModalLabel">Confirm Account Creation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Please confirm your account details:</p>
                <div class="mb-3">
                    <label class="form-label">Email:</label>
                    <p id="confirmEmail" class="fw-bold"></p>
                </div>
                <div class="mb-3">
                    <label class="form-label">Username:</label>
                    <p id="confirmUsername" class="fw-bold"></p>
                </div>
                <p>By creating an account, you agree to our Terms of Service and Privacy Policy.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" id="confirmSignUp" class="btn btn-primary">Create Account</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='scripts/signUp.js') }}"></script>

{% endblock %}